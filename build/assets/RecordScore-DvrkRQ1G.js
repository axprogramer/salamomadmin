import{r as l,j as e,i as P,k as g,o as v,m as F}from"./index-BOW9aXAt.js";import"./firebaseConfig-C2RYo4BK.js";import"./sweetalert2.all-CknvBjmT.js";import"./index.es-BNppl9rn.js";import{c as re}from"./index-Bu4Rb6mX.js";import{u as le}from"./ThemeProvider-aP-gzk9j.js";const oe=l.forwardRef(({bsPrefix:T,className:w,striped:p,bordered:E,borderless:D,hover:K,size:y,variant:I,responsive:b,...C},S)=>{const u=le(T,"table"),f=re(w,u,I&&`${u}-${I}`,y&&`${u}-${y}`,p&&`${u}-${typeof p=="string"?`striped-${p}`:"striped"}`,E&&`${u}-bordered`,D&&`${u}-borderless`,K&&`${u}-hover`),x=e.jsx("table",{...C,className:f,ref:S});if(b){let h=`${u}-responsive`;return typeof b=="string"&&(h=`${h}-${b}`),e.jsx("div",{className:h,children:x})}return x}),be=()=>{const[T,w]=l.useState([]),[p,E]=l.useState([]),[D,K]=l.useState([]),[y,I]=l.useState([]),[b,C]=l.useState([]),[S,u]=l.useState(localStorage.getItem("user_class")||"default"),[f,x]=l.useState(localStorage.getItem("user_classEn")||"default"),[h,H]=l.useState(localStorage.getItem("user_subs")||"default"),[_,c]=l.useState(localStorage.getItem("user_subsKh")||"default"),[i,V]=l.useState(localStorage.getItem("user_month")||"default"),[$,ce]=l.useState(localStorage.getItem("user_year")||"default"),[L,ne]=l.useState(localStorage.getItem("setSubs")||"default"),[G,X]=l.useState([]),[ie,Y]=l.useState({}),j=P(),q=g(j,"/SalaMOM/tools/permitted"),z=g(j,"/SalaMOM/tools/class/បឋមសិក្សា"),W=g(j,"/SalaMOM/tools/class/អនុវិទ្យាល័យ"),Q=g(j,"/SalaMOM/tools/class/វិទ្យាល័យ");l.useEffect(()=>{v(q,a=>{const r=a.val();I(r?Object.values(r):[])}),v(z,a=>{const r=a.val();w(r?Object.values(r):[])}),v(W,a=>{const r=a.val();E(r?Object.values(r):[])}),v(Q,a=>{const r=a.val();K(r?Object.values(r):[])})},[]),l.useEffect(()=>{const a=L.split(" ").filter(r=>r);X(a)},[]),l.useEffect(()=>{localStorage.setItem("user_class",f),x(localStorage.getItem("user_classEn")||"default")},[f]),l.useEffect(()=>{localStorage.setItem("user_class",S),u(localStorage.getItem("user_class")||"default")},[S]),l.useEffect(()=>{localStorage.setItem("user_subs",h),H(localStorage.getItem("user_subs")||"default")},[h]),l.useEffect(()=>{localStorage.setItem("user_subsKh",_),c(localStorage.getItem("user_subsKh")||"default")},[h]),l.useEffect(()=>{localStorage.setItem("user_month",i),V(localStorage.getItem("user_month")||"default")},[i]),l.useEffect(()=>{const a=g(j,`/SalaMOM/classes/${$}/`+f);v(a,r=>{const t=r.val();Y(t||{}),C(t?Object.values(t):[])})},[]);const U=a=>{const r=a.target.value;u(r);var[t]=r.substring(0,2).split(" "),[s]=r.substring(3,10).split(" ");s=="PE"&&(c("កីឡា"),localStorage.setItem("user_subsKh","កីឡា")),s=="E"&&(c("អង់គ្លេស"),localStorage.setItem("user_subsKh","អង់គ្លេស")),s=="ICT"&&(c("កុំព្យូទ័រ"),localStorage.setItem("user_subsKh","កុំព្យូទ័រ")),s=="M"&&(c("គណិតវិទ្យា"),localStorage.setItem("user_subsKh","គណិតវិទ្យា")),s=="C"&&(c("គីមីវិទ្យា"),localStorage.setItem("user_subsKh","គីមីវិទ្យា")),s=="Ho"&&(c("គេហៈ"),localStorage.setItem("user_subsKh","គេហៈ")),s=="Bio"&&(c("ជីវៈវិទ្យា"),localStorage.setItem("user_subsKh","ជីវៈវិទ្យា")),s=="H"&&(c("ប្រវត្តិវិទ្យា"),localStorage.setItem("user_subsKh","ប្រវត្តិវិទ្យា")),s=="ES"&&(c("ផែនដីវិទ្យា"),localStorage.setItem("user_subsKh","ផែនដីវិទ្យា")),s=="G"&&(c("ភូមិវិទ្យា"),localStorage.setItem("user_subsKh","ភូមិវិទ្យា")),s=="P"&&(c("រូបវិទ្យា"),localStorage.setItem("user_subsKh","រូបវិទ្យា")),s=="Ac"&&(c("សកម្មភាព"),localStorage.setItem("user_subsKh","សកម្មភាព")),s=="Bi"&&(c("សិក្សាសីលធម៌"),localStorage.setItem("user_subsKh","សិក្សាសីលធម៌")),s=="Mo"&&(c("សីលធម៌-ពលរដ្ឋ"),localStorage.setItem("user_subsKh","សីលធម៌-ពលរដ្ឋ")),s=="Eco"&&(c("សេដ្ឋកិច្ច"),localStorage.setItem("user_subsKh","សេដ្ឋកិច្ច")),s=="K"&&(c("អក្សរសាស្ត្រខ្មែរ"),localStorage.setItem("user_subsKh","អក្សរសាស្ត្រខ្មែរ")),s=="Sci"&&(c("វិទ្យាសាស្ត្រ"),localStorage.setItem("user_subsKh","វិទ្យាសាស្ត្រ")),s=="Soc"&&(c("សិក្សាសង្គម"),localStorage.setItem("user_subsKh","សិក្សាសង្គម")),localStorage.setItem("user_class",r),localStorage.setItem("user_classEn",t.replace(/\b0+/g,"")),localStorage.setItem("user_subs",s),x(t),H(s),window.location.reload()},Z=a=>{const r=a.target.value;localStorage.setItem("user_month",r),window.location.reload()},ee=()=>e.jsxs("select",{className:"form-control text-center",value:S,onChange:U,style:{color:"black",lineHeight:"2",height:"2.5rem"},id:"sle_grade",children:[e.jsx("option",{children:"ជ្រើសរើសថ្នាក់"}),G.map((a,r)=>e.jsx("option",{value:a.replace(/\b0+/g,""),children:a.replace(/\b0+/g,"")},a))]}),te=()=>{if(h==="E")return e.jsx(e.Fragment,{children:e.jsx("thead",{children:e.jsxs("tr",{className:"frezze",children:[e.jsx("th",{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"ល.រ"}),e.jsx("th",{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"ឈ្មោះពេញ"}),e.jsx("th",{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"ភេទ"}),e.jsx("th",{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:_}),e.jsxs("th",{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:["កិ.",_]})]})})})};function A(a){const r=document.createRange();r.selectNodeContents(a.target);const t=window.getSelection();t.removeAllRanges(),t.addRange(r)}const se=()=>{const a=P(),[r,t]=l.useState(""),s=l.useRef(null);s.current&&t(s.current.value);const o=n=>{const d=n.target.dataset.id,N=n.target.innerHTML;F(g(a,`/SalaMOM/classes/${$}/${f}/`+d),{e_moct:N}),console.log(n.target.dataset.id),console.log(n.target.innerHTML)};if(i==="October"&&h==="E")return b.map((d,N)=>{d.id,d.gender,d.e_moct,d.e_h_moct;const ae=m=>{const M=m.target.dataset.id,k=m.target.textContent;setTimeout(()=>{F(g(a,`/SalaMOM/classes/${$}/${f}/`+M),{e_h_moct:k})},2e3)};return e.jsx(e.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-center",children:N+1}),e.jsx("td",{className:"text-center",children:d.id}),e.jsx("td",{className:"text-center",children:d.gender}),e.jsx("td",{className:"text-center","data-e_moct1":N+1,onKeyDown:m=>{if(m.key==="Enter"){m.preventDefault();const M=m.target,k=parseInt(M.dataset.e_moct1),R=document.querySelector(`[data-e_moct1="${k+1}"]`),O=document.activeElement;if(O&&O.tagName==="TD"&&O.textContent,R){const J=document.createRange();J.selectNodeContents(M);const B=window.getSelection();B.removeAllRanges(),B.addRange(J),R.focus()}}},onClick:m=>{A(m)},"data-id":d.id,ref:s,contentEditable:!0,suppressContentEditableWarning:!0,onBlur:o,dangerouslySetInnerHTML:{__html:d.e_moct}}),e.jsx("td",{contentEditable:!0,className:"text-center",onClick:m=>{A(m)},"data-id":d.id,onInput:ae,children:d.e_h_moct})]},d.id)})})};return e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 grid-margin",children:e.jsx("div",{className:"card card-primary card-outline",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{style:{overflowX:"auto",padding:"15px"},children:e.jsx("div",{className:"text-center",children:e.jsx("table",{className:"table border-0 table-hover",children:e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"border-0 text-center",children:[e.jsx("label",{for:"user_teacher_id",className:"fw-bold",children:"ជ្រើសរើសថ្នាក់"}),e.jsx(ee,{})]}),e.jsxs("td",{className:"border-0 text-center",children:[e.jsx("label",{for:"user_teacher_id",className:"fw-bold",children:"មុខវិជ្ជា"}),e.jsx("select",{className:"form-control text-center",disabled:!0,style:{color:"black",lineHeight:"2",height:"2.5rem"},id:"sle_subs",children:e.jsx("option",{value:_,children:_})})]}),e.jsxs("td",{className:"border-0 text-center",children:[e.jsx("label",{for:"user_teacher_id",className:"fw-bold",children:"ជ្រើសរើសខែ"}),e.jsxs("select",{className:"form-control text-center",value:i,onChange:Z,style:{color:"black",lineHeight:"2",height:"2.5rem"},id:"sle_month",children:[e.jsx("option",{children:"ជ្រើសរើសខែ"}),y.map((a,r)=>{a.id;var t=a.show_add_month,s=a.status,o="";t=="October"&&(o="តុលា"),t=="November"&&(o="វិច្ឆិកា"),t=="December"&&(o="ធ្នូ"),t=="January"&&(o="មករា"),t=="February"&&(o="កុម្ភៈ"),t=="March"&&(o="មីនា"),t=="April-May"&&(o="មេសា-ឧសភា"),t=="June"&&(o="មិថុនា"),t=="July"&&(o="កក្កដា"),t=="1st Semester"&&(o="ឆមាសទី១"),t=="2nd Semester"&&(o="ឆមាសទី២");var n="";if(i=="October"&&(n="តុលា"),i=="November"&&(n="វិច្ឆិកា"),i=="December"&&(n="ធ្នូ"),i=="January"&&(n="មករា"),i=="February"&&(n="កុម្ភៈ"),i=="March"&&(n="មីនា"),i=="April-May"&&(n="មេសា-ឧសភា"),i=="June"&&(n="មិថុនា"),i=="July"&&(n="កក្កដា"),i=="1st Semester"&&(n="ឆមាសទី១"),i=="2nd Semester"&&(n="ឆមាសទី២"),["1st Semester","2nd Semester"].includes(i)?setTimeout(()=>{document.getElementById("month_title").innerHTML=`សម្រាប់៖${n}`},500):setTimeout(()=>{document.getElementById("month_title").innerHTML=`ខែ៖${n}`},500),t=="October"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="November"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="December"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="January"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="February"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="March"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="April-May"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="June"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="July"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="1st Semester"&&s=="active")return e.jsx("option",{value:t,children:o});if(t=="2nd Semester"&&s=="active")return e.jsx("option",{value:t,children:o})})]})]})]})})})})})})})}),e.jsx("div",{className:"col-12 grid-margin",children:e.jsx("div",{className:"card card-primary card-outline",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"row",children:e.jsxs("h4",{className:"card-title",children:["បញ្ចូលពិន្ទុសិស្សថ្នាក់ទី",e.jsx("strong",{style:{color:"rgb(255, 0, 119)"},id:"grade_title",children:f})," ",e.jsx("strong",{style:{color:"rgb(14, 90, 5)"},id:"month_title"})]})})}),e.jsx("div",{style:{overflowX:"auto",padding:"15px"},children:e.jsxs(oe,{className:"table table-bordered table-hover",children:[e.jsx(te,{}),e.jsx("tbody",{children:e.jsx(se,{})})]})})]})})})]})};export{be as default};
