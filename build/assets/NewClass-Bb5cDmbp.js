import{r as o,i as _,k as d,o as N,j as e,s as M,m as k,n as B}from"./index-BOW9aXAt.js";import"./firebaseConfig-C2RYo4BK.js";import{S as m}from"./sweetalert2.all-CknvBjmT.js";import{C as w}from"./index.es-BNppl9rn.js";import{c as Q}from"./cil-plus-D8mtC-W5.js";import{C as W,a as Y,b as I,c as b,d as Z}from"./CTable-R-4nV3n8.js";import{C as K}from"./CButton-DTyOUR8Q.js";import{c as $,a as ee}from"./cil-trash-BwZseM3u.js";import{c as le}from"./cil-pen-53d2I-C-.js";const de=()=>{const[R,y]=o.useState([]),[L,T]=o.useState([]),a=o.useRef(null),c=o.useRef(null),n=o.useRef(null),s=o.useRef(null),[u,E]=o.useState(""),[v,i]=o.useState(""),[t,O]=o.useState(localStorage.getItem("New_class_level")||"default"),A=o.useRef(null),p=o.useRef(""),C=o.useRef(""),S=o.useRef(""),h=_(),D=d(h,"SalaMOM/staffs"),P=d(h,"/SalaMOM/tools/class/បឋមសិក្សា"),U=d(h,"/SalaMOM/tools/class/អនុវិទ្យាល័យ"),H=d(h,"/SalaMOM/tools/class/វិទ្យាល័យ");o.useEffect(()=>{N(D,l=>{const r=l.val();T(r?Object.values(r):[])}),t=="បឋមសិក្សា"&&N(P,l=>{const r=l.val();y(r?Object.values(r):[])}),t=="អនុវិទ្យាល័យ"&&N(U,l=>{const r=l.val();y(r?Object.values(r):[])}),t=="វិទ្យាល័យ"&&N(H,l=>{const r=l.val();y(r?Object.values(r):[])}),a.current.value=u,p.current.style.display="none"},[t]),o.useEffect(()=>{t&&(A.current=t)},[]);const z=l=>l.get_url_pic?e.jsx("img",{className:"me-3",style:{width:"50px"},src:l.get_url_pic,alt:"image"}):e.jsx("img",{className:"me-3",style:{width:"50px"},src:"https://res.cloudinary.com/salamomschool/image/upload/v1709357129/fab63d7f9d9dd9de94019d884eac4a25.png",alt:"image"});setTimeout(()=>{const l=document.querySelector(".dropdown-content"),r=document.getElementById("user_teacher_id"),j=document.getElementById("user_url");l.addEventListener("click",f=>{if(f.target.tagName==="LI"){const g=f.target.dataset.label,x=f.target.dataset.image;r.value=g,j.value=x,i(g),s.current.value=x,l.classList.remove("show")}})},500);const G=l=>{const r=l.target.dataset.clen,j=l.target.dataset.clkh,f=l.target.dataset.level,g=l.target.dataset.picture,x=l.target.dataset.headteacher;a.current.value=j,c.current.value=r,s.current?s.current.value=g:s.current.value="",i(x||""),n.current.value=f,E(j),C.current.style.display="none",p.current.style.display="inline-block",S.current.style.display="inline-block"},q=()=>{C.current.style.display="inline-block",p.current.style.display="none",S.current.style.display="none",a.current.value=null,c.current.value=null,n.current.value=t},F=()=>{const l=_();u?(t==="បឋមសិក្សា"&&(m.fire({text:"ព័ត៍មានបានបញ្ចូលត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),M(d(l,"/SalaMOM/tools/class/បឋមសិក្សា/"+u),{id:a.current.value,level:n.current.value,clEn:c.current.value,clKh:a.current.value,head_teacher:v,picture:s.current.value}),a.current.value=null,c.current.value=null,s.current.value=null,n.current.value=t,i("")),t==="អនុវិទ្យាល័យ"&&(m.fire({text:"ព័ត៍មានបានបញ្ចូលត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),M(d(l,"/SalaMOM/tools/class/អនុវិទ្យាល័យ/"+u),{id:a.current.value,level:n.current.value,clEn:c.current.value,clKh:a.current.value,head_teacher:v,picture:s.current.value}),a.current.value=null,c.current.value=null,s.current.value=null,n.current.value=t,i("")),t==="វិទ្យាល័យ"&&(m.fire({text:"ព័ត៍មានបានបញ្ចូលត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),M(d(l,"/SalaMOM/tools/class/វិទ្យាល័យ/"+u),{id:a.current.value,level:n.current.value,clEn:c.current.value,clKh:a.current.value,head_teacher:v,picture:s.current.value}),a.current.value=null,c.current.value=null,s.current.value=null,n.current.value=t,i(""))):m.fire({text:"ព័ត៍មានមិនត្រឹមត្រូវ!",icon:"error",showConfirmButton:!1,timer:2200})},V=()=>{const l=_();u?(t==="បឋមសិក្សា"&&(m.fire({text:"ព័ត៍មានបានកែត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),k(d(l,"/SalaMOM/tools/class/បឋមសិក្សា/"+u),{id:a.current.value,level:n.current.value,clEn:c.current.value,clKh:a.current.value,head_teacher:v,picture:s.current.value}),a.current.value=null,c.current.value=null,s.current.value=null,n.current.value=t,i("")),t==="អនុវិទ្យាល័យ"&&(m.fire({text:"ព័ត៍មានបានកែត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),k(d(l,"/SalaMOM/tools/class/អនុវិទ្យាល័យ/"+u),{id:a.current.value,level:n.current.value,clEn:c.current.value,clKh:a.current.value,head_teacher:v,picture:s.current.value}),a.current.value=null,c.current.value=null,s.current.value=null,n.current.value=t,i("")),t==="វិទ្យាល័យ"&&(m.fire({text:"ព័ត៍មានបានកែត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),k(d(l,"/SalaMOM/tools/class/វិទ្យាល័យ/"+u),{id:a.current.value,level:n.current.value,clEn:c.current.value,clKh:a.current.value,head_teacher:v,picture:s.current.value}),a.current.value=null,c.current.value=null,n.current.value=t,s.current.value=null,i(""))):m.fire({text:"ព័ត៍មានមិនកែត្រឹមត្រូវ!",icon:"error",showConfirmButton:!1,timer:2200})},X=l=>{u?(t==="បឋមសិក្សា"&&(m.fire({text:"ព័ត៍មានបានលុបត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),B(d(h,"/SalaMOM/tools/class/បឋមសិក្សា/"+u)),a.current.value=null,c.current.value=null,n.current.value=t,s.current.value=null,i("")),t==="អនុវិទ្យាល័យ"&&(m.fire({text:"ព័ត៍មានបានលុបត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),B(d(h,"/SalaMOM/tools/class/អនុវិទ្យាល័យ/"+u)),a.current.value=null,c.current.value=null,n.current.value=t,s.current.value=null,i("")),t==="វិទ្យាល័យ"&&(m.fire({text:"ព័ត៍មានបានលុបត្រឹមត្រូវ!",icon:"success",showConfirmButton:!1,timer:2200}),B(d(h,"/SalaMOM/tools/class/វិទ្យាល័យ/"+u)),a.current.value=null,c.current.value=null,n.current.value=t,s.current.value=null,i(""))):m.fire({text:"ព័ត៍មានមិនលុបត្រឹមត្រូវ!",icon:"error",showConfirmButton:!1,timer:2200})};o.useEffect(()=>{localStorage.setItem("New_class_level",t),O(localStorage.getItem("New_class_level")||"default")},[t]);const J=()=>e.jsx("div",{children:e.jsxs("select",{className:"btn btn-primary btn-sm text-center me-3",value:t,onChange:l=>O(l.target.value),style:{color:"white",lineHeight:"1"},id:"sle_level",children:[e.jsx("option",{value:"កម្រិតថ្នាក់",children:"កម្រិតថ្នាក់"}),e.jsx("option",{value:"បឋមសិក្សា",children:"បឋមសិក្សា"}),e.jsx("option",{value:"អនុវិទ្យាល័យ",children:"អនុវិទ្យាល័យ"}),e.jsx("option",{value:"វិទ្យាល័យ",children:"វិទ្យាល័យ"})]})});return e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12 grid-margin",children:e.jsx("div",{className:"card card-primary card-outline",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"row",children:[e.jsx("h4",{className:"card-title",children:"បង្កើតថ្នាក់ថ្មី"}),e.jsxs("div",{className:"d-flex justify-content-center",children:[e.jsx(J,{}),e.jsxs("button",{onClick:q,"data-bs-toggle":"modal","data-bs-target":"#AddNewSub",style:{color:"white"},id:"btn_upload",type:"button",className:"btn btn-success btn-sm",children:[e.jsx(w,{icon:Q})," បង្កើតថ្មី"]})]}),e.jsx("div",{})]})}),e.jsxs("div",{style:{overflowX:"auto",padding:"15px"},children:[e.jsxs(W,{className:"table table-bordered table-hover",children:[e.jsx(Y,{children:e.jsxs(I,{className:"frezze",children:[e.jsx(b,{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"ល.រ"}),e.jsx(b,{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"ថ្នាក់ជាភាសារខ្មែរ"}),e.jsx(b,{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"ថ្នាក់ជាភាសារអង់គ្លេស"}),e.jsx(b,{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"គ្រូបន្ទុកថ្នាក់"}),e.jsx(b,{style:{backgroundColor:"rgb(23, 116, 153)",color:"white"},className:"border-dark text-center",children:"កម្រិតថ្នាក់"})]})}),e.jsx(Z,{children:R.map((l,r)=>e.jsxs(I,{children:[e.jsx("td",{className:"text-center",children:r+1}),e.jsx("td",{className:"text-center",onClick:G,"data-bs-toggle":"modal","data-bs-target":"#AddNewSub","data-clkh":l.clKh,"data-clen":l.clEn,"data-level":l.level,"data-picture":l.picture,"data-headteacher":l.head_teacher,"data-clid":l.id,children:l.clKh}),e.jsx("td",{className:"text-center",children:l.clEn}),e.jsx("td",{className:"text-center",children:l.head_teacher}),e.jsx("td",{className:"text-center",children:l.level})]}))})]}),e.jsx("div",{className:"modal fade",id:"AddNewSub",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"form-group row",children:e.jsxs("p",{children:[e.jsxs("div",{className:"form-group row",children:[e.jsxs("div",{className:"dropdown dropup",children:[e.jsx("button",{className:"btn dropdown-toggle",type:"button",id:"dropdownMenuName","data-bs-toggle":"dropdown","aria-expanded":"false",children:"ជ្រើសរើសគ្រូ"}),e.jsx("ul",{className:"dropdown-menu menu-lg-scroll dropdown-content","aria-labelledby":"dropdownMenuName",id:"select_username",children:L.map((l,r)=>e.jsxs("li",{class:"dropdown-item","data-label":l.id,"data-image":l.get_url_pic,children:[e.jsxs("span",{className:"me-3",children:[r+1,"."]}),z(l),l.id]}))})]}),e.jsx("label",{className:"col-sm-3 fw-bold",children:"គ្រូបន្ទុកថ្នាក់"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("input",{className:"form-control",type:"text",value:v,onInput:l=>{i(l.target.value)},name:"user[username]",id:"user_teacher_id"})})]}),e.jsx("input",{className:"form-control",type:"hidden",ref:s,name:"user[username]",id:"user_url"})]})})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 fw-bold",children:"ថ្នាក់ជាភាសារខ្មែរ"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("input",{onChange:l=>{E(l.target.value)},ref:a,type:"text",className:"form-control",id:"subKh"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 fw-bold",children:"ថ្នាក់ជាភាសារអង់គ្លេស"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("input",{ref:c,type:"text",className:"form-control",id:"subEn"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 fw-bold",children:"កម្រិតថ្នាក់"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("input",{ref:n,type:"text",className:"form-control",id:"subAbr"})})]})})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs(K,{ref:C,onClick:F,style:{color:"white"},type:"button",className:"btn btn-success btn-sm",children:[e.jsx(w,{icon:$}),"   បញ្ចូល"]}),e.jsxs(K,{ref:p,onClick:V,style:{color:"white"},type:"button",className:"btn btn-warning btn-sm",children:[e.jsx(w,{icon:le}),"   កែ"]}),e.jsx("button",{ref:S,onClick:X,style:{color:"white"},id:"btn_upload",type:"button",className:"btn btn-danger btn-sm",children:e.jsx(w,{icon:ee})})]})]})})})]})]})})})})};export{de as default};
